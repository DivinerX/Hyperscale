import { createAsyncThunk, createSlice, PayloadAction } from '@reduxjs/toolkit';
import axiosInstance from '@/services/axios';
import { ICoinInfo, ICoinState } from '@/Types';

export const getCoinInfo = createAsyncThunk('coin/getCoinInfo',
  async () => {
    const response = await axiosInstance.get('/api/coin/info');
    return response.data;
  }
);
export const getGraphData = createAsyncThunk('coin/getGraphData',
  async ({ name, days }: { name: string; days: number }) => {
    try {
      const response = await axiosInstance.get('/api/coin/graph', {
        params: {
          "name": name,
          "days": days,
        },
      });
      return response.data;
    } catch (error) {
      console.error(error);
      throw error;
    }
  }
);

const initialState: ICoinState = {
  coinInfo: [],
  invest: 65000,
  historicalData: [
    [1708646400000, 51319.5001257027],
    [1708732800000, 50841.0810947709],
    [1708819200000, 51553.0967128311],
    [1708905600000, 51751.8840549346],
    [1708992000000, 54478.191083123],
    [1709078400000, 57003.5267373081],
    [1709164800000, 62558.5820241931],
    [1709251200000, 61298.2168611016],
    [1709337600000, 62426.6405291919],
    [1709424000000, 62067.8668021218],
    [1709510400000, 63053.1054390642],
    [1709596800000, 68186.6459343215],
    [1709683200000, 64291.5365575695],
    [1709769600000, 66145.9192785085],
    [1709856000000, 66944.8763905358],
    [1709942400000, 68315.2519207831],
    [1710028800000, 68508.0039626159],
    [1710115200000, 69075.6668819574],
    [1710201600000, 72130.5530076568],
    [1710288000000, 71467.1735032606],
    [1710374400000, 73097.7670269413],
    [1710460800000, 71420.0318014235],
    [1710547200000, 69497.7631929463],
    [1710633600000, 65292.3132933129],
    [1710720000000, 68425.4156564305],
    [1710806400000, 67708.9436093081],
    [1710892800000, 62132.5173787344],
    [1710979200000, 67819.0557068403],
    [1711065600000, 65535.9784484766],
    [1711152000000, 63509.0449652313],
    [1711238400000, 64285.802791022],
    [1711324800000, 67310.9832681011],
    [1711411200000, 69938.9453020024],
    [1711497600000, 70082.0512247598],
    [1711584000000, 69435.7504030521],
    [1711670400000, 70710.1953486331],
    [1711756800000, 69919.0554614861],
    [1711843200000, 69702.3087473573],
    [1711929600000, 71246.9514406015],
    [1712016000000, 69785.9250380237],
    [1712102400000, 65440.4192258716],
    [1712188800000, 66123.938539074],
    [1712275200000, 68542.1771527951],
    [1712361600000, 67978.6102340851],
    [1712448000000, 69000.6499164776],
    [1712534400000, 69401.9736091101],
    [1712620800000, 71624.18486237],
    [1712707200000, 69158.6438120767],
    [1712793600000, 70527.8899757896],
    [1712880000000, 70106.6641307095],
    [1712966400000, 67252.1050422663],
    [1713052800000, 64404.8254890741],
    [1713139200000, 65752.6600472888],
    [1713225600000, 63430.5714573684],
    [1713312000000, 63720.5015874807],
    [1713398400000, 61328.8979886073],
    [1713484800000, 63461.5926951072],
    [1713571200000, 63988.8184717857],
    [1713657600000, 64894.4186910918],
    [1713744000000, 64936.4207567739],
    [1713830400000, 66841.6668520736],
    [1713916800000, 66406.9524439267],
    [1714003200000, 64279.5181285752],
    [1714089600000, 64486.183359159],
    [1714176000000, 63802.3300492588],
    [1714262400000, 63517.2487434096],
    [1714348800000, 63030.4336166819],
    [1714435200000, 63797.6796358996],
    [1714521600000, 60749.4720921639],
    [1714608000000, 58297.5740753255],
    [1714694400000, 59135.1733607733],
    [1714780800000, 62839.3407356938],
    [1714867200000, 63820.451902925],
    [1714953600000, 64010.0086521089],
    [1715040000000, 63172.4812955134],
    [1715126400000, 62363.0571917186],
    [1715212800000, 61215.5040087919],
    [1715299200000, 63148.599943097],
    [1715385600000, 60888.2167495716],
    [1715472000000, 60776.9720791721],
    [1715558400000, 61507.0540041213],
    [1715644800000, 62878.7833007293],
    [1715731200000, 61569.1130057734],
    [1715817600000, 66220.5183143283],
    [1715904000000, 65260.8798033462],
    [1715990400000, 67053.1232650956],
    [1716076800000, 66912.618614037],
    [1716163200000, 66252.7125959161],
    [1716249600000, 71430.2970021515],
    [1716336000000, 70189.8358177002],
    [1716422400000, 69181.2008567776],
    [1716508800000, 67906.4653427611],
    [1716595200000, 68539.9164655299],
    [1716681600000, 69268.4455897377],
    [1716768000000, 68508.831108757],
    [1716854400000, 69367.2387175573],
    [1716940800000, 68316.6358804963],
    [1717027200000, 67577.2655899596],
    [1717113600000, 68372.4928843409],
    [1717200000000, 67474.9548369841],
    [1717286400000, 67704.3264181152],
    [1717372800000, 67740.0169022248],
    [1717459200000, 68808.2936859055],
    [1717545600000, 70600.0111667609],
    [1717632000000, 71184.599430592],
    [1717718400000, 70759.5881930143],
    [1717804800000, 69325.3623884722],
    [1717891200000, 69315.1041233966],
    [1717977600000, 69654.1607376036],
    [1718064000000, 69493.1776091574],
    [1718150400000, 67329.1523272432],
    [1718236800000, 68224.5196750199],
    [1718323200000, 66700.3169656438],
    [1718409600000, 66011.0787371373],
    [1718496000000, 66190.4874891135],
    [1718582400000, 66615.5378213177],
    [1718668800000, 66460.3889790995],
    [1718755200000, 65109.3148121905],
    [1718841600000, 64907.0746076032],
    [1718928000000, 64844.6744179776],
    [1719014400000, 64071.6242847097],
    [1719100800000, 64239.9034881315],
    [1719187200000, 63221.3573843748],
    [1719273600000, 60363.2349752963],
    [1719360000000, 61770.4138700954],
    [1719446400000, 60749.8961940201],
    [1719532800000, 61562.6453255004],
    [1719619200000, 60317.0969794512],
    [1719705600000, 60864.4431619343],
    [1719792000000, 62734.3938394547],
    [1719878400000, 62819.8222692185],
    [1719964800000, 62042.5650371006],
    [1720051200000, 60244.6807643309],
    [1720137600000, 57189.1741240864],
    [1720224000000, 56739.862851072],
    [1720310400000, 58230.4841542266],
    [1720396800000, 55880.3753776708],
    [1720483200000, 56665.1407335203],
    [1720569600000, 57988.303512084],
    [1720656000000, 57704.2022844629],
    [1720742400000, 57388.1924791667],
    [1720828800000, 57899.2889574959],
    [1720915200000, 59152.7191388729],
    [1721001600000, 60942.3277399629],
    [1721088000000, 64835.4897332157],
    [1721174400000, 65162.2362523435],
    [1721260800000, 64136.3138436069],
    [1721347200000, 63959.5690080938],
    [1721433600000, 66689.5488073496],
    [1721520000000, 67206.0647061489],
    [1721606400000, 68088.1399632453],
    [1721692800000, 67607.7133991887],
    [1721779200000, 65942.4174652284],
    [1721865600000, 65403.5351302253],
    [1721952000000, 65749.9636196533],
    [1722038400000, 67920.2964857025],
    [1722124800000, 68055.4083896874],
    [1722211200000, 68242.2474440493],
    [1722297600000, 66770.3209184827],
    [1722384000000, 66219.051024861],
    [1722470400000, 64679.7786470325],
    [1722556800000, 65357.5296076744],
    [1722643200000, 61407.2954739745],
    [1722729600000, 60738.7449250574],
    [1722816000000, 58006.2065866867],
    [1722902400000, 53956.2618415974],
    [1722988800000, 55959.8410739936],
    [1723075200000, 55099.9518114674],
    [1723161600000, 61859.0315990416],
    [1723248000000, 60912.5885333508],
    [1723334400000, 60887.708616415],
    [1723420800000, 58804.2344999261],
    [1723507200000, 59350.074332707],
    [1723593600000, 60601.2231778973],
    [1723680000000, 58739.1938223102],
    [1723766400000, 57624.1169285219],
    [1723852800000, 58881.9257915122],
    [1723939200000, 59430.7916344587],
    [1724025600000, 58438.2937426854],
    [1724112000000, 59574.9458129409],
    [1724198400000, 59060.1261007414],
    [1724284800000, 61144.6876286661],
    [1724371200000, 60387.5406232136],
    [1724457600000, 64049.6856155558],
    [1724544000000, 64157.1606134782],
    [1724630400000, 64265.8163127286],
    [1724716800000, 62922.5863467627],
    [1724803200000, 59526.560879591],
    [1724889600000, 59015.2963388794],
    [1724976000000, 59351.5794909728],
    [1725062400000, 59156.2460364636],
    [1725148800000, 58960.2365866459],
    [1725235200000, 57357.7161728225],
    [1725321600000, 59108.7323586369],
    [1725408000000, 57504.5385862204],
    [1725494400000, 57987.8460141007],
    [1725580800000, 56132.4047320886],
    [1725667200000, 53923.3561107191],
    [1725753600000, 54150.9383589072],
    [1725840000000, 54792.4075576858],
    [1725926400000, 57049.1187511433],
    [1726012800000, 57624.1617833614],
    [1726099200000, 57381.7644450005],
    [1726185600000, 58106.9512298153],
    [1726272000000, 60620.6274729575],
    [1726358400000, 60003.2994008304],
    [1726444800000, 59214.8022680181],
    [1726531200000, 58211.1232312863],
    [1726617600000, 60317.0319794625],
    [1726704000000, 61440.4120849451],
    [1726790400000, 62966.5293191051],
    [1726876800000, 63128.2245407483],
    [1726963200000, 63403.4023492594],
    [1727049600000, 63582.5995692483],
    [1727136000000, 63327.026544502],
    [1727222400000, 64334.142748761],
    [1727308800000, 63151.8995940134],
    [1727395200000, 65130.7688402323],
    [1727481600000, 65791.0021254174],
    [1727568000000, 65934.1070944136],
    [1727654400000, 65663.6898666234],
    [1727740800000, 63243.2753246438],
    [1727827200000, 60872.6685437255],
    [1727913600000, 60655.5597919685],
    [1728000000000, 60727.863951693],
    [1728086400000, 62103.0104728325],
    [1728172800000, 62091.932585194],
    [1728259200000, 62811.7997281127],
    [1728345600000, 62287.3901051068],
    [1728432000000, 62185.2304237276],
    [1728518400000, 60597.1504561828],
    [1728604800000, 60195.1807377245],
    [1728691200000, 62392.3404829316],
    [1728777600000, 63207.7706212756],
    [1728864000000, 62829.5336860889],
    [1728950400000, 66049.9949270802],
    [1729036800000, 66962.2199449679],
    [1729123200000, 67647.5441476687],
    [1729209600000, 67328.1052700299],
    [1729296000000, 68465.6192066874],
    [1729382400000, 68388.8712896527],
    [1729468800000, 68962.8291804569],
    [1729555200000, 67394.8577573562],
    [1729641600000, 67351.047935125],
    [1729728000000, 66683.9680654231],
    [1729814400000, 68214.052051574],
    [1729900800000, 66585.6653550145],
    [1729987200000, 67018.1650170265],
    [1730073600000, 67938.5541288567],
    [1730160000000, 69845.304531169],
    [1730246400000, 72781.1130815813],
    [1730332800000, 72342.6217112799],
    [1730419200000, 70264.9973557328],
    [1730505600000, 69507.9225639565],
    [1730592000000, 69299.1603669941],
    [1730678400000, 68803.5062627747],
    [1730764800000, 67793.2978270476],
    [1730851200000, 69335.4255313376],
    [1730937600000, 75620.8860696319],
    [1731024000000, 75987.2417832067],
    [1731110400000, 76550.0213845611],
    [1731196800000, 76630.2263141538],
    [1731283200000, 80466.7165483354],
    [1731369600000, 88637.4200032291],
    [1731456000000, 88264.599745829],
    [1731542400000, 90488.1000749785],
    [1731628800000, 87407.5127371013],
    [1731715200000, 90947.975094437],
    [1731801600000, 90606.4548938071],
    [1731888000000, 89841.4719413511],
    [1731974400000, 90534.6245965029],
    [1732060800000, 92251.6524073831],
    [1732147200000, 94217.0222963421],
    [1732233600000, 98509.1185910243],
    [1732320000000, 98927.494945534],
    [1732406400000, 97679.4638164303],
    [1732492800000, 98015.9355289458],
    [1732579200000, 93004.7009310329],
    [1732665600000, 91931.8307729183],
    [1732752000000, 95981.1805721056],
    [1732838400000, 95661.5959581785],
    [1732924800000, 97453.2473451042],
    [1733011200000, 96513.1423469823],
    [1733097600000, 97311.7071908432],
    [1733184000000, 95833.1362300365],
    [1733270400000, 96031.6309775983],
    [1733356800000, 98881.4694561823],
    [1733443200000, 97201.5003640774],
    [1733529600000, 99973.8515065983],
    [1733616000000, 99781.8299919817],
    [1733702400000, 101235.371702532],
    [1733788800000, 97353.9470082089],
    [1733875200000, 96649.7144677153],
    [1733961600000, 101123.618110337],
    [1734048000000, 100000.808365352],
    [1734134400000, 101352.229712923],
    [1734220800000, 101367.010645534],
    [1734307200000, 104721.50151809],
    [1734393600000, 106074.107235412],
    [1734480000000, 106034.913402645],
    [1734529869000, 104716.255068833]
  ],
  loading: false,
  error: null,
};

const coinSlice = createSlice({
  name: 'coin',
  initialState,
  reducers: {
    setCoinInfo: (state, action: PayloadAction<ICoinInfo[]>) => {
      state.coinInfo = action.payload;
    },
  },
  extraReducers: (builder) => {
    builder.addCase(getCoinInfo.fulfilled, (state, action) => {
      state.coinInfo = action.payload;
      state.loading = false;
      state.error = null;
    });
    builder.addCase(getCoinInfo.pending, (state) => {
      state.loading = true;
    });
    builder.addCase(getCoinInfo.rejected, (state, action) => {
      state.loading = false;
      state.error = action.error.message || null;
    });
    builder.addCase(getGraphData.fulfilled, (state, action) => {
      state.historicalData = action.payload;
      state.loading = false;
      state.error = null;
    });
    builder.addCase(getGraphData.pending, (state) => {
      state.loading = true;
    });
    builder.addCase(getGraphData.rejected, (state, action) => {
      state.loading = false;
      state.error = action.error.message || null;
    });
  },
});

export const { setCoinInfo } = coinSlice.actions;
export default coinSlice.reducer;

